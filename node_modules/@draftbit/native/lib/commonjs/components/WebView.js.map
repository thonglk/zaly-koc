{"version":3,"sources":["WebView.tsx"],"names":["injectFirst","NativeWebView","source","style","height","setHeight","React","useState","onMessage","event","Number","nativeEvent","data","flexGrow","BrowserWebView","flatStyles","StyleSheet","flatten","createElement","width","src","uri","srcDoc","html","allowFullScreen","seamless","Platform","select","native","default","SEED_DATA","name","tag","description","category","COMPONENT_TYPES","media","layout","flex","props","defaultValue"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAOA;;;;;;AAEA;AACA,MAAMA,WAAW,GAAI;AACrB;AACA;AACA;AACA,CAJA;;AAWA,MAAMC,aAA8B,GAAG,CAAC;AAAEC,EAAAA,MAAF;AAAUC,EAAAA;AAAV,CAAD,KAAuB;AAC5D,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBC,KAAK,CAACC,QAAN,CAAe,CAAf,CAA5B;;AACA,QAAMC,SAAS,GAAIC,KAAD,IAChBJ,SAAS,CAACK,MAAM,CAACD,KAAK,CAACE,WAAN,CAAkBC,IAAnB,CAAP,CADX;;AAEA,sBACE,oBAAC,uBAAD;AACE,IAAA,qBAAqB,EAAE;AAAEC,MAAAA,QAAQ,EAAE,CAAZ;AAAeT,MAAAA,MAAM,EAAE,CAAAD,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAEC,MAAP,KAAiBA;AAAxC;AADzB,kBAGE,oBAAC,2BAAD;AACE,IAAA,MAAM,EAAEF,MADV;AAEE,IAAA,KAAK,EAAEC,KAFT;AAGE,IAAA,kBAAkB,EAAEH,WAHtB;AAIE,IAAA,SAAS,EAAEQ;AAJb,IAHF,CADF;AAYD,CAhBD;;AAkBA,MAAMM,cAA+B,GAAG,CAAC;AAAEZ,EAAAA,MAAF;AAAUC,EAAAA;AAAV,CAAD,KAAuB;AAC7D,QAAMY,UAAU,GAAGC,wBAAWC,OAAX,CAAmBd,KAAnB,CAAnB;;AACA,sBAAOG,KAAK,CAACY,aAAN,CAAoB,QAApB,EAA8B;AACnCf,IAAAA,KAAK,EAAEY,UAD4B;AAEnCX,IAAAA,MAAM,EAAEW,UAAF,aAAEA,UAAF,uBAAEA,UAAU,CAAEX,MAFe;AAGnCe,IAAAA,KAAK,EAAEJ,UAAF,aAAEA,UAAF,uBAAEA,UAAU,CAAEI,KAHgB;AAInCC,IAAAA,GAAG,EAAGlB,MAAH,aAAGA,MAAH,uBAAGA,MAAD,CAA8BmB,GAJA;AAKnCC,IAAAA,MAAM,EAAGpB,MAAH,aAAGA,MAAH,uBAAGA,MAAD,CAA+BqB,IALJ;AAMnCC,IAAAA,eAAe,EAAE,IANkB;AAOnCC,IAAAA,QAAQ,EAAE;AAPyB,GAA9B,CAAP;AASD,CAXD;;eAaeC,sBAASC,MAAT,CAAgB;AAC7BC,EAAAA,MAAM,EAAE3B,aADqB;AAE7B4B,EAAAA,OAAO,EAAEf;AAFoB,CAAhB,C;;;AAKR,MAAMgB,SAAS,GAAG;AACvBC,EAAAA,IAAI,EAAE,UADiB;AAEvBC,EAAAA,GAAG,EAAE,SAFkB;AAGvBC,EAAAA,WAAW,EAAE,kCAHU;AAIvBC,EAAAA,QAAQ,EAAEC,uBAAgBC,KAJH;AAKvBC,EAAAA,MAAM,EAAE;AAAEC,IAAAA,IAAI,EAAE;AAAR,GALe;AAMvBC,EAAAA,KAAK,EAAE;AACLrC,IAAAA,MAAM,EAAE,6BAAiB;AACvBsC,MAAAA,YAAY,EAAE;AADS,KAAjB;AADH;AANgB,CAAlB","sourcesContent":["import * as React from \"react\";\nimport { Platform, ScrollView, StyleSheet, ViewStyle } from \"react-native\";\nimport { WebView } from \"react-native-webview\";\nimport {\n  WebViewMessageEvent,\n  WebViewSourceHtml,\n  WebViewSourceUri,\n} from \"react-native-webview/lib/WebViewTypes\";\n\nimport { COMPONENT_TYPES, createSourceProp } from \"@draftbit/types\";\n\n// Auto-height fix (if this is not present, scrolling on Android does not work)\nconst injectFirst = `\n  window.ReactNativeWebView.postMessage(\n    Math.max(document.body.offsetHeight, document.body.scrollHeight)\n  );\n`;\n\ninterface Props {\n  source: WebViewSourceUri | WebViewSourceHtml;\n  style?: ViewStyle;\n}\n\nconst NativeWebView: React.FC<Props> = ({ source, style }) => {\n  const [height, setHeight] = React.useState(0);\n  const onMessage = (event: WebViewMessageEvent) =>\n    setHeight(Number(event.nativeEvent.data));\n  return (\n    <ScrollView\n      contentContainerStyle={{ flexGrow: 1, height: style?.height || height }}\n    >\n      <WebView\n        source={source}\n        style={style}\n        injectedJavaScript={injectFirst}\n        onMessage={onMessage}\n      />\n    </ScrollView>\n  );\n};\n\nconst BrowserWebView: React.FC<Props> = ({ source, style }) => {\n  const flatStyles = StyleSheet.flatten(style);\n  return React.createElement(\"iframe\", {\n    style: flatStyles,\n    height: flatStyles?.height,\n    width: flatStyles?.width,\n    src: (source as WebViewSourceUri)?.uri,\n    srcDoc: (source as WebViewSourceHtml)?.html,\n    allowFullScreen: true,\n    seamless: true,\n  });\n};\n\nexport default Platform.select({\n  native: NativeWebView,\n  default: BrowserWebView,\n});\n\nexport const SEED_DATA = {\n  name: \"Web View\",\n  tag: \"WebView\",\n  description: \"Render web content inside a view\",\n  category: COMPONENT_TYPES.media,\n  layout: { flex: 1 },\n  props: {\n    source: createSourceProp({\n      defaultValue: \"https://reactnative.dev\",\n    }),\n  },\n};\n"]}