{"version":3,"sources":["WebView.tsx"],"names":["React","Platform","ScrollView","StyleSheet","WebView","COMPONENT_TYPES","createSourceProp","injectFirst","NativeWebView","source","style","height","setHeight","useState","onMessage","event","Number","nativeEvent","data","flexGrow","BrowserWebView","flatStyles","flatten","createElement","width","src","uri","srcDoc","html","allowFullScreen","seamless","select","native","default","SEED_DATA","name","tag","description","category","media","layout","flex","props","defaultValue"],"mappings":"AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAASC,QAAT,EAAmBC,UAAnB,EAA+BC,UAA/B,QAA4D,cAA5D;AACA,SAASC,OAAT,QAAwB,sBAAxB;AAOA,SAASC,eAAT,EAA0BC,gBAA1B,QAAkD,iBAAlD,C,CAEA;;AACA,MAAMC,WAAW,GAAI;AACrB;AACA;AACA;AACA,CAJA;;AAWA,MAAMC,aAA8B,GAAG,CAAC;AAAEC,EAAAA,MAAF;AAAUC,EAAAA;AAAV,CAAD,KAAuB;AAC5D,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBZ,KAAK,CAACa,QAAN,CAAe,CAAf,CAA5B;;AACA,QAAMC,SAAS,GAAIC,KAAD,IAChBH,SAAS,CAACI,MAAM,CAACD,KAAK,CAACE,WAAN,CAAkBC,IAAnB,CAAP,CADX;;AAEA,sBACE,oBAAC,UAAD;AACE,IAAA,qBAAqB,EAAE;AAAEC,MAAAA,QAAQ,EAAE,CAAZ;AAAeR,MAAAA,MAAM,EAAE,CAAAD,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAEC,MAAP,KAAiBA;AAAxC;AADzB,kBAGE,oBAAC,OAAD;AACE,IAAA,MAAM,EAAEF,MADV;AAEE,IAAA,KAAK,EAAEC,KAFT;AAGE,IAAA,kBAAkB,EAAEH,WAHtB;AAIE,IAAA,SAAS,EAAEO;AAJb,IAHF,CADF;AAYD,CAhBD;;AAkBA,MAAMM,cAA+B,GAAG,CAAC;AAAEX,EAAAA,MAAF;AAAUC,EAAAA;AAAV,CAAD,KAAuB;AAC7D,QAAMW,UAAU,GAAGlB,UAAU,CAACmB,OAAX,CAAmBZ,KAAnB,CAAnB;AACA,sBAAOV,KAAK,CAACuB,aAAN,CAAoB,QAApB,EAA8B;AACnCb,IAAAA,KAAK,EAAEW,UAD4B;AAEnCV,IAAAA,MAAM,EAAEU,UAAF,aAAEA,UAAF,uBAAEA,UAAU,CAAEV,MAFe;AAGnCa,IAAAA,KAAK,EAAEH,UAAF,aAAEA,UAAF,uBAAEA,UAAU,CAAEG,KAHgB;AAInCC,IAAAA,GAAG,EAAGhB,MAAH,aAAGA,MAAH,uBAAGA,MAAD,CAA8BiB,GAJA;AAKnCC,IAAAA,MAAM,EAAGlB,MAAH,aAAGA,MAAH,uBAAGA,MAAD,CAA+BmB,IALJ;AAMnCC,IAAAA,eAAe,EAAE,IANkB;AAOnCC,IAAAA,QAAQ,EAAE;AAPyB,GAA9B,CAAP;AASD,CAXD;;AAaA,eAAe7B,QAAQ,CAAC8B,MAAT,CAAgB;AAC7BC,EAAAA,MAAM,EAAExB,aADqB;AAE7ByB,EAAAA,OAAO,EAAEb;AAFoB,CAAhB,CAAf;AAKA,OAAO,MAAMc,SAAS,GAAG;AACvBC,EAAAA,IAAI,EAAE,UADiB;AAEvBC,EAAAA,GAAG,EAAE,SAFkB;AAGvBC,EAAAA,WAAW,EAAE,kCAHU;AAIvBC,EAAAA,QAAQ,EAAEjC,eAAe,CAACkC,KAJH;AAKvBC,EAAAA,MAAM,EAAE;AAAEC,IAAAA,IAAI,EAAE;AAAR,GALe;AAMvBC,EAAAA,KAAK,EAAE;AACLjC,IAAAA,MAAM,EAAEH,gBAAgB,CAAC;AACvBqC,MAAAA,YAAY,EAAE;AADS,KAAD;AADnB;AANgB,CAAlB","sourcesContent":["import * as React from \"react\";\nimport { Platform, ScrollView, StyleSheet, ViewStyle } from \"react-native\";\nimport { WebView } from \"react-native-webview\";\nimport {\n  WebViewMessageEvent,\n  WebViewSourceHtml,\n  WebViewSourceUri,\n} from \"react-native-webview/lib/WebViewTypes\";\n\nimport { COMPONENT_TYPES, createSourceProp } from \"@draftbit/types\";\n\n// Auto-height fix (if this is not present, scrolling on Android does not work)\nconst injectFirst = `\n  window.ReactNativeWebView.postMessage(\n    Math.max(document.body.offsetHeight, document.body.scrollHeight)\n  );\n`;\n\ninterface Props {\n  source: WebViewSourceUri | WebViewSourceHtml;\n  style?: ViewStyle;\n}\n\nconst NativeWebView: React.FC<Props> = ({ source, style }) => {\n  const [height, setHeight] = React.useState(0);\n  const onMessage = (event: WebViewMessageEvent) =>\n    setHeight(Number(event.nativeEvent.data));\n  return (\n    <ScrollView\n      contentContainerStyle={{ flexGrow: 1, height: style?.height || height }}\n    >\n      <WebView\n        source={source}\n        style={style}\n        injectedJavaScript={injectFirst}\n        onMessage={onMessage}\n      />\n    </ScrollView>\n  );\n};\n\nconst BrowserWebView: React.FC<Props> = ({ source, style }) => {\n  const flatStyles = StyleSheet.flatten(style);\n  return React.createElement(\"iframe\", {\n    style: flatStyles,\n    height: flatStyles?.height,\n    width: flatStyles?.width,\n    src: (source as WebViewSourceUri)?.uri,\n    srcDoc: (source as WebViewSourceHtml)?.html,\n    allowFullScreen: true,\n    seamless: true,\n  });\n};\n\nexport default Platform.select({\n  native: NativeWebView,\n  default: BrowserWebView,\n});\n\nexport const SEED_DATA = {\n  name: \"Web View\",\n  tag: \"WebView\",\n  description: \"Render web content inside a view\",\n  category: COMPONENT_TYPES.media,\n  layout: { flex: 1 },\n  props: {\n    source: createSourceProp({\n      defaultValue: \"https://reactnative.dev\",\n    }),\n  },\n};\n"]}