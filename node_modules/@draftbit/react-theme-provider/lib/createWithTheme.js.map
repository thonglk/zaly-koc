{"version":3,"sources":["../src/createWithTheme.js"],"names":["createWithTheme","ThemeProvider","ThemeContext","withTheme","Comp","overrides","ThemedComponent","a","b","c","previous","_previous","result","render","props","_reactThemeProviderForwardedRef","rest","theme","_merge","React","Component","ResultComponent","forwardRef","ref","displayName","name"],"mappings":";;;;;AAEA;;AACA;;AACA;;;;;;;;;;;;;;;;AAYA,IAAMA,eAAe,GAAG,SAAlBA,eAAkB,CACtBC,aADsB,EAEtBC,YAFsB;AAAA,SAItB,SAASC,SAAT,CAAmBC,IAAnB,EAA4BC,SAA5B,EAAuD;AAAA,QAC/CC,eAD+C;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA;;AAAA,iEAI1C,UAACC,CAAD,EAAOC,CAAP,EAAcC,CAAd,EAAwB;AAC/B,cAAMC,QAAQ,GAAG,MAAKC,SAAtB;;AAEA,cACED,QAAQ,IACRA,QAAQ,CAACH,CAAT,KAAeA,CADf,IAEAG,QAAQ,CAACF,CAAT,KAAeA,CAFf,IAGAE,QAAQ,CAACD,CAAT,KAAeA,CAJjB,EAKE;AACA,mBAAOC,QAAQ,CAACE,MAAhB;AACD;;AAED,cAAIA,MAAM,GAAGL,CAAC,IAAIC,CAAL,IAAUD,CAAC,KAAKC,CAAhB,GAAoB,wBAAUD,CAAV,EAAaC,CAAb,CAApB,GAAsCD,CAAC,IAAIC,CAAxD;AACAI,UAAAA,MAAM,GAAGH,CAAC,IAAIG,MAAM,KAAKH,CAAhB,GAAoB,wBAAUG,MAAV,EAAkBH,CAAlB,CAApB,GAA2CG,MAApD;AAEA,gBAAKD,SAAL,GAAiB;AAAEJ,YAAAA,CAAC,EAADA,CAAF;AAAKC,YAAAA,CAAC,EAADA,CAAL;AAAQC,YAAAA,CAAC,EAADA,CAAR;AAAWG,YAAAA,MAAM,EAANA;AAAX,WAAjB;AAEA,iBAAOA,MAAP;AACD,SAtBkD;;AAAA;AAAA;;AAAA;;AAAA,aAwBnDC,MAxBmD,GAwBnD,kBAAS;AAAA;;AAAA,0BAC8C,KAAKC,KADnD;AAAA,YACCC,+BADD,eACCA,+BADD;AAAA,YACqCC,IADrC;;AAGP,eACE,oBAAC,YAAD,CAAc,QAAd,QACG,UAAAC,KAAK;AAAA,iBACJ,oBAAC,IAAD,eACMD,IADN;AAEE,YAAA,KAAK,EAAE,MAAI,CAACE,MAAL,CAAYD,KAAZ,EAAmBD,IAAI,CAACC,KAAxB,EAA+BZ,SAA/B,CAFT;AAGE,YAAA,GAAG,EAAEU;AAHP,aADI;AAAA,SADR,CADF;AAWD,OAtCkD;;AAAA;AAAA,MACvBI,KAAK,CAACC,SADiB;;AAyCrD,QAAMC,eAAe,GAAGF,KAAK,CAACG,UAAN,CAAiB,UAACR,KAAD,EAAQS,GAAR;AAAA,aACvC,oBAAC,eAAD,eAAqBT,KAArB;AAA4B,QAAA,+BAA+B,EAAES;AAA7D,SADuC;AAAA,KAAjB,CAAxB;AAIAF,IAAAA,eAAe,CAACG,WAAhB,mBAA2CpB,IAAI,CAACoB,WAAL,IAAoBpB,IAAI,CAACqB,IAApE;AAEA,uCAAqBJ,eAArB,EAAsCjB,IAAtC;AAEA,WAAQiB,eAAR;AACD,GAtDqB;AAAA,CAAxB;;eAwDerB,e","sourcesContent":["/* @flow */\n\nimport * as React from 'react';\nimport deepmerge from 'deepmerge';\nimport hoistNonReactStatics from 'hoist-non-react-statics';\n\nimport type { ThemeProviderType } from './createThemeProvider';\nimport type { $DeepShape } from './types';\n\nexport type WithThemeType<T> = <P, C: React.ComponentType<P>>(\n  Comp: C\n) => C &\n  React.ComponentType<\n    $Diff<React.ElementConfig<C>, { theme: T }> & { theme?: $DeepShape<T> }\n  >;\n\nconst createWithTheme = <T: Object, S: $DeepShape<T>>(\n  ThemeProvider: ThemeProviderType<T>,\n  ThemeContext: React.Context<T>\n) =>\n  function withTheme(Comp: *, overrides?: $DeepShape<T>) {\n    class ThemedComponent extends React.Component<*> {\n      _previous: ?{ a: T, b: ?S, c: ?S, result: T };\n\n      _merge = (a: T, b: ?S, c: ?S) => {\n        const previous = this._previous;\n\n        if (\n          previous &&\n          previous.a === a &&\n          previous.b === b &&\n          previous.c === c\n        ) {\n          return previous.result;\n        }\n\n        let result = a && b && a !== b ? deepmerge(a, b) : a || b;\n        result = c && result !== c ? deepmerge(result, c) : result;\n\n        this._previous = { a, b, c, result };\n\n        return result;\n      };\n\n      render() {\n        const { _reactThemeProviderForwardedRef, ...rest } = this.props;\n\n        return (\n          <ThemeContext.Consumer>\n            {theme => (\n              <Comp\n                {...rest}\n                theme={this._merge(theme, rest.theme, overrides)}\n                ref={_reactThemeProviderForwardedRef}\n              />\n            )}\n          </ThemeContext.Consumer>\n        );\n      }\n    }\n\n    const ResultComponent = React.forwardRef((props, ref) => (\n      <ThemedComponent {...props} _reactThemeProviderForwardedRef={ref} />\n    ));\n\n    ResultComponent.displayName = `withTheme(${Comp.displayName || Comp.name})`;\n\n    hoistNonReactStatics(ResultComponent, Comp);\n\n    return (ResultComponent: any);\n  };\n\nexport default createWithTheme;\n"],"file":"createWithTheme.js"}